package com.foru.blog.config.consumer;import com.alibaba.fastjson.JSON;import com.foru.blog.constant.MQPrefixConst;import com.foru.blog.dao.OperationLogDao;import com.foru.blog.entity.OperationLog;import org.apache.rocketmq.spring.annotation.ConsumeMode;import org.apache.rocketmq.spring.annotation.RocketMQMessageListener;import org.apache.rocketmq.spring.core.RocketMQListener;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Component;/** * @ClassName LogConsumer * @Author 9527 */@Component@RocketMQMessageListener(topic = MQPrefixConst.LOG_TOPIC, consumerGroup = MQPrefixConst.MQ_GROUP_LOG, consumeMode = ConsumeMode.CONCURRENTLY)public class LogConsumer implements RocketMQListener<String> {    private OperationLogDao operationLogDao;    @Autowired    public void setOperationLogDao(OperationLogDao operationLogDao) {        this.operationLogDao = operationLogDao;    }    @Override    public void onMessage(String s) {        OperationLog log = JSON.parseObject(s, OperationLog.class);        operationLogDao.insert(log);    }}